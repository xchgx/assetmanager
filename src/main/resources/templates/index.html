<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="zh">
<head th:replace="temp :: head">
    <title>资产管理系统</title>
</head>
<body>

<!-- Fixed navbar -->
<nav class="navbar navbar-default navbar-fixed-top" th:replace="temp::nav"></nav>

<div class="container" style="margin-top: 80px;">
    <div class="row">
        <div class="col-xs-12">
            <div class="alert alert-success" role="alert" th:text="'当前资产实体数量：'+${#lists.size(assets)}"></div>
        </div>
    </div>
    <div class="row">
        <div class="col-xs-3" th:each="ast : ${assets}" >
            <a th:href="'/assetById?assetId='+${ast.id}"><div class="qr" th:id="${ast.id}"></div></a>
            <div><h1 th:text="${ast.name}+'('+${ast.id}+')'"></h1></div>
            <div><h2 th:text="'使用者：'+${ast.username?:'暂无'}"></h2></div>
            <div><h2 th:text="'入库单号：'+${ast.rukudanId}"></h2></div>
            <div><h2 th:text="'状态：'+${ast.status}"></h2></div>

            <div th:if="${session.get('user')}">
                <a th:href="|javascript:toUrl('/application/addQuick?type=已使用&assetId=${ast.id}')|" type="button" class="btn btn-primary btn-xs" th:if="${ast.status=='空闲'}">领用申请</a>
                <a href="javascript:void 0;" type="button" class="btn btn-primary btn-xs disabled" th:unless="${ast.status=='空闲'}" disabled="true">领用申请</a>
                <a th:href="|javascript:toUrl('/application/addQuick?type=借用&assetId=${ast.id}')|" type="button" class="btn btn-warning btn-xs" th:if="${ast.status=='空闲'}">借用申请</a>
                <a href="javascript:void 0;" type="button" class="btn btn-warning btn-xs disabled" th:unless="${ast.status == '空闲'}" disabled="true">借用申请</a>
                <a th:href="|javascript:toUrl('/application/addQuick?type=维修&assetId=${ast.id}')|" type="button" class="btn btn-warning btn-xs" th:if="${ast.status == '已使用' || ast.status == '借用'}">维修申请</a>
                <a href="javascript:void 0;" type="button" class="btn btn-warning btn-xs disabled" th:unless="${ast.status == '已使用' || ast.status == '借用'}" disabled="true">维修申请</a>
                <a th:href="|javascript:toUrl('/application/addQuick?type=空闲&assetId=${ast.id}')|" type="button" class="btn btn-success btn-xs" th:if="${ast.status == '已使用' || ast.status == '借用'}">归还申请</a>
                <a href="javascript:void 0;" type="button" class="btn btn-success btn-xs disabled" th:unless="${ast.status == '已使用' || ast.status == '借用'}" disabled="true">归还申请</a>
            </div>
            <!--            <a th:href="|/asset/set?status=空闲&assetId=${ast.id}|" type="button" class="btn btn-success">设置空闲</a>-->
<!--            <a th:href="|/asset/set?status=维修&assetId=${ast.id}|" type="button" class="btn btn-success">设置维修</a>-->
<!--            <a th:href="|/asset/set?status=报废&assetId=${ast.id}|" type="button" class="btn btn-success">设置报废</a>-->
        </div>
    </div>
</div> <!-- /container -->


<div style="height: 100px"></div>
<footer th:replace="temp :: footer"></footer>

<!-- jQuery (Bootstrap 的所有 JavaScript 插件都依赖 jQuery，所以必须放在前边) -->
<script src="/js/jquery-1.10.2.min.js"></script>
<!-- 加载 Bootstrap 的所有 JavaScript 插件。你也可以根据需要只加载单个插件。 -->
<script src="/js/bootstrap.min.js"></script>
<script src="/js/qrcode.min.js"></script>

<script>
    var qrs = document.getElementsByClassName("qr");
    if (qrs.length) {
        for(var i in qrs){
            new QRCode(qrs[i],"http://xchgx.vicp.net/assetById?assetId="+qrs[i].id);
        }
    }

    function toUrl(url) {
        $.getJSON(url,function (res) {//当成功获得服务器的返回时，执行函数代码
            location.href = location.href;//刷新
        })
    }
</script>
</body>
</html>